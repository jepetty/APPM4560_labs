\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage[margin=1in]{geometry}               % See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   	% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
						% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{array}
\usepackage{indentfirst}
\usepackage{enumitem}
\usepackage{mathptmx}
\usepackage{float}

%SetFonts

%SetFonts

\setcounter{secnumdepth}{3} % default value for 'report' class is "2"

\title{APPM 4560 Laboratory 2 Report}
\author{Rhys Olsen\\
\texttt{rhys.olsen@colorado.edu}
 \and Jessica Petty\\
 \texttt{jessica.petty@colorado.edu}
 }
\date{November 16, 2016}

\begin{document}
\maketitle
\part{Simulating a homogenous Poisson process (HPP)}
\section{}
The random variables $T(1), \dots, T(N)$ represent the times of the arrivals of the HPP on the domain $[0, t]$. Note that while $[0, t]$ is pre-determined by the way the problem is posed, $N$ is a random variable based on how many arrivals the simulation generates on $[0, t]$ and is \emph{not} pre-determined.
\section{}
As $N$ represents the number of arrivals of a Poisson process in a time window of size $t - 0 = t$, $N \sim \text{Poisson}(\lambda t)$.
\section{}
As $T(N)$ is defined as the time of the last arrival of the HPP in time interval $[0, t]$, $T(N + 1)$ represents the time of the first arrival of the HPP \emph{after} time $t$.
\section{}
The random variable $T(N + 1) - t$ is the amount of time taken after $t$ until the next arrival of the HPP. Each individual arrival of the HPP, including $T(N + 1)$, is exponentially distributed with rate paramater $\lambda$ by assumption. Since $N(T)$ is the \emph{last} arrival of the HPP on $[0, t]$, we have that $T(N + 1) > t$. By the memoryless property, $P(N(T + 1) > t + s | N(T + 1) > t) = P(N(T + 1) > s)$, which amounts to saying that $T(N + 1) - t \sim \text{Exp}(\lambda)$
\section{}
The random variables $T(N + 1) - t$ and $T(N + 1) - T(N)$ do \emph{not} have the same distribution.

Observe that $T(N)$ is the maximum among $U_1, \dots, U_N \sim_{\text{i.i.d.}} \text{Uniform}(0, t)$, so:
$$P(T(N) < t) = P(U_1 < t, \dots, U_N < t)$$
which by independence is:
$$P(U_1 < t) \times \dots \times P(U_N < t)$$
and as $P(U_1 < t), \dots,  P(U_N < t)$ are all identically distributed, for $U \sim \text{Uniform}(0, t)$, this is simply:
$$P(U < t))^n = \left( \int_{0}^{t} p_U(x) \mathrm{d}x \right)^n = \left(\frac{t}{t}\right)^n = 1^n = 1$$

Thus we always have that $T(N) < t \Rightarrow T(N + 1) - T(N) > T(N + 1) - t$.
\section{}
Having argued that $T(N + 1) - t \sim \text{Exp}(\lambda)$, we expect $T(N + 1) \sim \text{Exp}(\lambda) + t$. To justify this, we derive the probability density function $f_{T(N + 1)}(x)$.

As $T(N)$ is by definition the last arrival time of the process before or during time $t$, it is not possible for $T(N + 1)$ to occur before or during time $t$. Thus $f_{T(N + 1)}(x) = 0$ for $x \leq t$. By the memoryless property of the exponential distribution, $P(T(N + 1) = t + s | T(N + 1) > t) = P(T(N + 1) = s)$, where the condition $T(N + 1) > t$ is given by the problem defintion. Moreover, on the a posteriori assumption that any further time increment $r$ elapses before $T(N + 1)$, the memoryless property also shows that $P(T(N + 1) = t + r + s | T(N + 1) > t + r) = P(T(N + 1) = s)$. The only distributrion that could satisfy these properties is an exponential with rate parameter $\lambda$ known to be greater than $t$, which is simply an exponential with rate paramater $\lambda$ shifted $t$ increments to the right. Thus:
\[
f_{T(N + 1)}(x) =
\begin{cases} 
      0 & x \leq t \\
      \lambda e^{-\lambda x} & x > t 
   \end{cases}
\]

\part{Simulating a Non-homogenous Poisson process (NHPP)}
\section{}
The algorithm to simulate a Nonhomogenous Poisson Point Process with intensity function $\lambda(t)$ is as follows:
\begin{enumerate}[leftmargin=30pt,labelindent=65pt,itemindent=30pt]
\item[\textsc{step 1:}] Calculate the maximum $C$ of the function $\lambda(t)$ on the interval $[0,T]$
\item[\textsc{step 2:}] Set $i:=0$, $T(0):=0$, and $N:=0$
\item[\textsc{step 3:}] Generate $U_1 \sim \text{Uniform}(0,1)$
\item[\textsc{step 4:}] Set $i:=i+1$ and $T(i) := T(i-1) - \ln(U_1)/C$
\item[\textsc{step 5:}] Generate $U_2 \sim\text{Uniform}(0,1)$
\item[\textsc{step 6:}] If $T(i) > t$, set $N:=N-1$ and stop. Otherwise, if $U_2 \leq \frac{\lambda(T(i))}{C}$, set $N:=N+1$. Go to Step 3.
\end{enumerate}

\section{}
$W$ represents the random number of arrivals in the time interval $[0, T]$ of a non-homogenous Poisson process with rate function $\lambda(t)$. The mean function corresponding to this rate function is $\Lambda(t) = \int_{0}^{t}\lambda(s)\mathrm{d}s $. Now, the expected number of arrivals $W$ of a non-homogenous Poisson process with intensity function $\lambda(t)$ over the interval $[0, T]$ has a distribution Poisson($\Lambda(T)$). 

Given a non-homogenous Poisson process with intensity function $\lambda(t)=t^2-10t+26$, the corresponding mean function is $\Lambda(t)=\frac{t^3}{3}-5t^2+26t$. Over the interval $[0,9]$, the mean function evaluates to $\Lambda(9)=\frac{9^3}{3} - 5(9)^2+26(9) = 72$. Therefore, the random variable $W$ has a theoretical distribution Poisson($72$).

Additionally, the expected value of a Poisson distribution with rate parameter $\lambda$ is $\lambda$. Therefore, $\mathbb{E}[W]=\mathbb{E}[Poisson(72)]=72$.

\section{}
Plot and analyze a simulation

\end{document}
