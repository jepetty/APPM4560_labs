\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage[margin=1in]{geometry}               % See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   	% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
						% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{array}
\usepackage{indentfirst}
\usepackage{enumitem}
\usepackage{mathptmx}
\usepackage{float}

%SetFonts

%SetFonts

\setcounter{secnumdepth}{3} % default value for 'report' class is "2"

\title{APPM 4560 Laboratory 2 Report}
\author{Rhys Olsen\\
\texttt{rhys.olsen@colorado.edu}
 \and Jessica Petty\\
 \texttt{jessica.petty@colorado.edu}
 }
\date{November 16, 2016}

\begin{document}
\maketitle
\part{Simulating a homogenous Poisson process (HPP)}
\section{}
The random variables $T(1), \dots, T(N)$ represent the times of the arrivals of the HPP on the domain $[0, t]$. Note that while $[0, t]$ is pre-determined by the way the problem is posed, $N$ is a random variable based on how many arrivals the simulation generates on $[0, t]$ and is \emph{not} pre-determined.
\section{}
As $N$ represents the number of arrivals of a Poisson process in a time window of size $t - 0 = t$, $N \sim \text{Poisson}(\lambda t)$.
\section{}
As $T(N)$ is defined as the time of the last arrival of the HPP in time interval $[0, t]$, $T(N + 1)$ represents the time of the first arrival of the HPP \emph{after} time $t$.
\section{}
The random variable $T(N + 1) - t$ is the amount of time taken after $t$ until the next arrival of the HPP. Each individual arrival of the HPP, including $T(N + 1)$, is exponentially distributed with rate paramater $\lambda$ by assumption. Since $N(T)$ is the \emph{last} arrival of the HPP on $[0, t]$, we have that $T(N + 1) > t$. By the memoryless property, $P(N(T + 1) > t + s | N(T + 1) > t) = P(N(T + 1) > s)$, which amounts to saying that $T(N + 1) - t \sim \text{Exp}(\lambda)$
\section{}
The random variables $T(N + 1) - t$ and $T(N + 1) - T(N)$ do \emph{not} have the same distribution.

Observe that $T(N)$ is the maximum among $U_1, \dots, U_N \sim_{\text{i.i.d.}} \text{Uniform}(0, t)$, so:
$$P(T(N) < t) = P(U_1 < t, \dots, U_N < t)$$
which by independence is:
$$P(U_1 < t) \times \dots \times P(U_N < t)$$
and as $P(U_1 < t), \dots,  P(U_N < t)$ are all identically distributed, for $U \sim \text{Uniform}(0, t)$, this is simply:
$$P(U < t))^n = \left( \int_{0}^{t} p_U(x) \mathrm{d}x \right)^n = \left(\frac{t}{t}\right)^n = 1^n = 1$$

Thus we always have that $T(N) < t \Rightarrow T(N + 1) - T(N) > T(N + 1) - t$.
\section{}
Having argued that $T(N + 1) - t \sim \text{Exp}(\lambda)$, we expect $T(N + 1) \sim \text{Exp}(\lambda) + t$. To justify this, we derive the probability density function $f_{T(N + 1)}(x)$.

As $T(N)$ is by definition the last arrival time of the process before or during time $t$, it is not possible for $T(N + 1)$ to occur before or during time $t$. Thus $f_{T(N + 1)}(x) = 0$ for $x \leq t$. By the memoryless property of the exponential distribution, $P(T(N + 1) = t + s | T(N + 1) > t) = P(T(N + 1) = s)$, where the condition $T(N + 1) > t$ is given by the problem defintion. Moreover, on the a posteriori assumption that any further time increment $r$ elapses before $T(N + 1)$, the memoryless property also shows that $P(T(N + 1) = t + r + s | T(N + 1) > t + r) = P(T(N + 1) = s)$. The only distributrion that could satisfy these properties is an exponential with rate parameter $\lambda$ known to be greater than $t$, which is simply an exponential with rate paramater $\lambda$ shifted $t$ increments to the right. Thus:
\[
f_{T(N + 1)}(x) =
\begin{cases} 
      0 & x \leq t \\
      \lambda e^{-\lambda x} & x > t 
   \end{cases}
\]

\part{Simulating a Non-homogenous Poisson process (NHPP)}
\section{}
The algorithm to simulate a Nonhomogenous Poisson Point Process with intensity function $\lambda(t)$ is as follows:
\begin{enumerate}[leftmargin=30pt,labelindent=65pt,itemindent=30pt]
\item[\textsc{step 1:}] Calculate the maximum $C$ of the function $\lambda(t)$ on the interval $[0,T]$
\item[\textsc{step 2:}] Set $i:=0$ and $T(0):=0$
\item[\textsc{step 3:}] Generate $U_1 \sim \text{Uniform}(0,1)$
\item[\textsc{step 4:}] Set $i := i + 1$ and $T(i) := T(i-1) - \ln(U_1)/C$
\item[\textsc{step 5:}] Generate $U_2 \sim\text{Uniform}(0,1)$
\item[\textsc{step 6:}] If $T(i) > t$ or if $U_2 > \frac{\lambda(T(i))}{C}$, set $N:=i-1$ and stop. Otherwise, go to Step 2.
\end{enumerate}
It is necessary to develop a constant $C$ such that $0\leq{\lambda}\leq{C}$. This comprises Step 1 of the algorithm, which is simple in the case posed by the problem. Because we have that $t$ is bounded between 0 and 9, we observe that the maximum of $\lambda(t) = t^2 - 10t + 26$ occurs at $t=0$, $\lambda(0)=26$.\\

For the intensity function $\lambda(t) = t^2 - 10 t + 26$, the corresponding $\Lambda(t) = \int_{0}^{t} s^2 - 10 s + 26 \mathrm{d}s = \left[ \frac{1}{3}s^3 - 5 s^2 + 26 s + C \right]_{0}^{t}$, which is simply $\frac{1}{3}t^3 - 5 t^2 + 26 t $.

\section{}
Theoretical description of $W$ and $\mathbb{E}[W]$

\section{}
Plot and analyze a simulation

\end{document}
